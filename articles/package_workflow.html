<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pyramidi">
<title>Package workflow â€¢ pyramidi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Package workflow">
<meta property="og:description" content="pyramidi">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pyramidi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/pyramidi.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/compose.html">Composing from R</a>
    <a class="dropdown-item" href="../articles/package_workflow.html">Package workflow</a>
    <a class="dropdown-item" href="../articles/functions_usage.html">Usage of pyramidi functions</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/urswilke/pyramidi/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="package_workflow_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="package_workflow_files/viz-1.8.2/viz.js"></script><link href="package_workflow_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="package_workflow_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Package workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/urswilke/pyramidi/blob/HEAD/vignettes/package_workflow.Rmd" class="external-link"><code>vignettes/package_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>package_workflow.Rmd</code></div>
    </div>

    
    
<p>The following diagram depicts the structure of the pyramidi package
and its python counterpart <a href="https://github.com/urswilke/miditapyr" class="external-link">miditapyr</a>.</p>
<p><em>Hover over nodes to see additional information. Many of the nodes
are also clickable for further information.</em></p>
<pre><code><span><span class="co">#&gt; Error in python_config_impl(python) : </span></span>
<span><span class="co">#&gt;   Error running '/home/runner/.virtualenvs/r-reticulate/python': No such file.</span></span>
<span><span class="co">#&gt; The Python installation used to create the virtualenv has been moved or removed:</span></span>
<span><span class="co">#&gt;   '/opt/hostedtoolcache/Python/3.11.8/x64/bin'</span></span></code></pre>
<div class="grViz html-widget html-fill-item" id="htmlwidget-13fdb0ca733a0521d8bd" style="width:8.5in;height:768px;"></div>
<script type="application/json" data-for="htmlwidget-13fdb0ca733a0521d8bd">{"x":{"diagram":"digraph pyramidi_flow {\n\n  # define graph\n  graph [\n    overlap = true,\n    newrank=true\n    fontsize = 20\n    fontname = jura\n  ]\n\n  # midi file paths\n  node [shape = folder, fontname = jura, peripheries=2, group = spaghetti]\n  midi_in [tooltip = \"Filepath of midi file on your computer to manipulate\"];\n  midi_out [tooltip = \"Filepath of output midi file\"];\n\n  subgraph cluster_legend {\n    label = < <B>legend<\/B> >;\n    fontsize = 20;\n    bgcolor=\"#FFD7AA44:#44466644\";\n\n    node [shape = folder, fontname = jura, peripheries=2]\n    mfp [\n      label = \"midi file\\npath\",\n      tooltip = \"Path of the midi file on your computer\"\n    ]\n\n    node [\n      shape = ellipse,\n      style = \"rounded,filled,radial\",\n      gradientangle=190\n    ]\n    pmf  [\n      label = \"pyramidi\\nfunction\",\n      tooltip = \"Function of the pyramidi R package\"\n      URL = \"https://urswilke.github.io/pyramidi/reference/index.html\",\n      fillcolor=\"#33D7AAFF:#CC4488FF\"\n    ]\n    mtf [\n      label = \"miditapyr\\nfunction\",\n      tooltip = \"Function of the miditapyr python package\"\n      URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html\",\n      fillcolor=\"#FFD700ff:#44A666ff\"\n    ]\n\n\n    node [shape = box, fontname = jura, peripheries=2, style=solid]\n    df [\n      label = \"data\\nframe\",\n      tooltip = \"pandas DataFrame or R data.frame\"\n    ]\n\n    node [shape = box, fontname = jura, peripheries = 1, style=dashed, penwidth = 2]\n    mfr_field [\n      label = \"field in\\nMidiFramer\",\n      tooltip = \"Field in a MidiFramer object\"\n      URL = \"https://urswilke.github.io/pyramidi/reference/MidiFramer.html#public-fields\"\n    ]\n\n    node [shape = box, fontname = jura, peripheries = 1, style=rounded, penwidth = 1]\n    mf_field [\n      label = \"field in\\nMidiFrames\",\n      tooltip = \"Field in a MidiFrames object\"\n      URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames\"\n    ]\n\n    node [shape = diamond, fontname = jura, peripheries = 1, style=rounded, penwidth = 1]\n    method [\n      label = \"method\",\n      tooltip = \"Class method\"\n    ]\n  }\n\n\n  subgraph cluster_miditapyr {\n    label = < <B>miditapyr<\/B> >;\n    fontsize = 20;\n    bgcolor=\"#FFD700:#44A666\";\n    tooltip = \"Library for MIDI TAbulation in PYthon and for R\";\n    URL = \"https://miditapyr.readthedocs.io/\"\n\n    node [shape = box, fontname = jura, peripheries=2, style=solid, group = spaghetti]\n    mf_raw; mf_unnested; mf_nested\n\n\n\n    ## mido:\n    subgraph cluster_mido {\n      tooltip = \"Library for working with MIDI messages and ports\"\n      URL = \"https://mido.readthedocs.io/\"\n      label = < <B>mido<\/B> >;\n      bgcolor=\"#FFD700:#CCA600\";\n      node [shape = box, fontname = jura, peripheries=2, style=rounded, group = spaghetti]\n      midi_file [\n        tooltip = \"mido.MidiFile object\"\n        URL = \"https://mido.readthedocs.io/en/latest/lib.html#mido.MidiFile\"\n      ];\n    }\n\n\n    node [\n      shape = ellipse,\n      style = \"rounded,filled,radial\",\n      gradientangle=190, fillcolor=\"#FFD700ff:#44A666ff\",\n      group = spaghetti\n    ]\n    mtfm [label = \"frame_midi\", URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.mido_io.frame_midi\", tooltip = \"Function to create a dataframe containing the information parsed by mido.MidiFile\"]\n    mtum [label = \"unnest_midi\", URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.mido_io.unnest_midi\", tooltip = \"Function to transform the dataframe returned by frame_midi in a tidy format (cf. https://r4ds.had.co.nz/tidy-data.html)\"]\n    mtnm [label = \"nest_midi\", URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.mido_io.nest_midi\", tooltip = \"Function to transform the dataframe returned by unnest_midi back to a format as in the result of unnest_midi\"]\n    mtwm [label = \"write_midi\", URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.mido_io.write_midi\", tooltip = \"Function to write midi dataframes returned by nest_midi back to a midi file\"]\n\n    edge [fontname = jura]\n\n\n    midi_file->mtfm[arrowhead=none, weight=1000]\n\n    mtfm->mf_raw [weight=1000];\n\n    mf_raw->mtum[arrowhead=none, weight=1000]\n\n    mtum->mf_unnested [weight=1000]\n\n    mf_unnested->mtnm[arrowhead=none, weight=1000]\n    mtnm->mf_nested [weight=1000]\n\n    mf_nested->mtwm[arrowhead=none, weight=1000]\n\n  subgraph cluster_mf {\n    label = < <B>mf<\/B> >;\n    style = dashed;\n    penwidth = 2;\n    bgcolor=\"#33D700:#CCA6DD\";\n    tooltip = \"MidiFrames object\";\n    URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames\";\n    fontname = jura\n\n    node   [\n      style=rounded\n      shape = box,\n      style = \"rounded,filled,radial\",\n      gradientangle=10, fillcolor=\"#aacc8874:#4455662f\",\n      peripheries=1\n    ]\n      mf_midi_file [\n        label = \"mf.midi_file\",\n        URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames.midi_file\"\n      ]\n      mf_mf_raw [\n        label = \"mf.midi_frame_raw\",\n        URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames.midi_frame_raw\"\n      ]\n      mf_mf_unnested [\n        label = \"mf.midi_frame_unnested\",\n        URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames.midi_frame_unnested\"\n        color = red\n      ]\n      mf_mf_nested [\n        label = \"mf.midi_frame_nested\",\n        URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames.midi_frame_nested\"\n        color = red\n      ]\n      mf_write_file [\n        style = rounded,\n        shape = diamond,\n        label = \"mf.write_file\",\n        URL = \"https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames.write_file\"\n      ]\n\n  }\n\n  }\n\n  subgraph cluster_pyramidi {\n    label = < <B>pyramidi<\/B> >;\n    fontsize = 20;\n    bgcolor=\"#33D7AA:#CC4488\";\n    tooltip = \"R library to reproducibly generate/manipulate midi data in data frames\";\n    URL = \"https://urswilke.github.io/pyramidi/\";\n    fontname = jura\n\n    node [\n      shape = ellipse,\n      style = \"rounded,filled,radial\",\n      gradientangle=190, fillcolor=\"#33D7AAFF:#CC4488FF\"\n    ]\n    ppln [label = \"pivot_long_notes\", URL = \"https://urswilke.github.io/pyramidi/reference/pivot_long_notes.html\", tooltip = \"Write note_on and note_off events in two lines (wide to long)\"]\n    split_midi_frame [URL = \"https://urswilke.github.io/pyramidi/reference/split_midi_frame.html\", tooltip = \"Unnested midi frame with time data from tab_measures() is split into 3 parts:\"]\n    merge_midi_frames [URL = \"https://urswilke.github.io/pyramidi/reference/merge_midi_frames.html\", tooltip = \"Merge dataframes transformed back to long format, remove added columns and transform to the right chronological order in order to replace the original midi_frame_unnested object.\"]\n\n    node [\n      shape = box,\n      fontname = jura,\n      peripheries=2,\n      style = dashed;\n      penwidth = 2;\n      ]\n    df_notes_wide [color = red]\n    dfm\n    df_meta\n    df_not_notes\n    df_notes_long [color = red]\n    midi_frame_mod [color = red]\n\n    node [\n      shape = ellipse,\n      style = \"rounded,filled,radial\",\n      penwidth = 1;\n      gradientangle=190, fillcolor=\"#33D7AAFF:#CC4488FF\"\n    ]\n    tab_measures [URL = \"https://urswilke.github.io/pyramidi/reference/tab_measures.html\", tooltip = \"This function mainly adds ticks which is the absolute value of midos time (measured in ticks) for every track. Furthermore, this absolute time value is translated to the further columns of beats (quarter notes; b), measures (bars; m) and the time in seconds (t). The function outputs these additional columns only if they are specified in the argument columns_to_add (see details).\"]\n    ppwn [label = \"pivot_wide_notes\", URL = \"https://urswilke.github.io/pyramidi/reference/pivot_wide_notes.html\", tooltip = \"Write note_on and note_off events in the same line (long to wide)\"]\n    update_notes_wide [color = red, shape = diamond, peripheries = 1, style=rounded, URL = \"https://urswilke.github.io/pyramidi/reference/MidiFramer.html#method-update_notes_wide\"]\n\n  }\n\n\n  # edges\n  edge [fontname = jura]\n\n  midi_in->midi_file\n\n  mf_mf_unnested->tab_measures[arrowhead=none]\n\n  tab_measures->dfm\n\n  dfm->split_midi_frame[arrowhead=none]\n  split_midi_frame->ppwn\n  split_midi_frame->df_meta\n  split_midi_frame->df_not_notes\n\n  df_meta->merge_midi_frames\n  df_not_notes->merge_midi_frames\n  df_notes_long->merge_midi_frames [color = red, penwidth = 2]\n\n  ppwn->df_notes_wide\n\n  df_notes_wide->ppln[arrowhead=none, color = red, penwidth = 2]\n\n  ppln->df_notes_long [color = red, penwidth = 2]\n\n\n  merge_midi_frames->midi_frame_mod [color = red, penwidth = 2]\n  midi_frame_mod->mf_mf_unnested [color = red, penwidth = 2]\n\n  mtwm->midi_out\n\n  {rank = same; df_notes_long; mtfm;}\n  {rank = same; merge_midi_frames; ppln;}\n  {rank = same; ppln; mf_raw;}\n  {rank = same; ppwn; tab_measures;}\n  {rank = same; mf_mf_unnested; df_meta;}\n  {rank = same; mf_mf_unnested; df_not_notes;}\n  {rank = same; mf_mf_unnested; df_notes_wide;}\n#  {rank = same; mf_mf_unnested; update_notes_wide;}\n  df_meta -> df_not_notes -> df_notes_wide -> update_notes_wide [ style=invis ];\n\n  mf_midi_file -> mf_mf_raw [weight=1000]\n  mf_mf_raw -> mf_mf_unnested [weight=1000]\n  mf_mf_unnested -> mf_mf_nested [color = red, penwidth = 2, weight=1000]\n  mf_mf_nested -> mf_write_file [weight=1000]\n  update_notes_wide->df_notes_wide [color = red, penwidth = 2]\n\n  {rank = same; mf_midi_file; midi_file}\n  {rank = same; mf_mf_raw; mf_raw}\n  {rank = same; mf_mf_unnested; mf_unnested}\n  {rank = same; mf_mf_nested; mf_nested}\n  {rank = same; mf_write_file; mtwm}\n\n  edge [style = dotted, arrowsize = 0.5]\n    mf_midi_file -> midi_file\n    mf_mf_raw -> mf_raw\n    mf_mf_unnested -> mf_unnested\n    mf_mf_nested -> mf_nested\n    mf_write_file -> mtwm\n\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><ul>
<li>
<code>miditapyr</code> can be used to load the midi file
<code>midi_in</code> into a <code>mido.MidiFile</code>. The chain down
to <code>midi_out</code> shows, how miditapyrâ€™s functions can be used to
transform the data into different formats and finally save it to a new
midi file. Have a look <a href="https://miditapyr.readthedocs.io/en/latest/notebooks/functions_usage.html" class="external-link">here</a>
to see in detail how this can be done.</li>
<li>
<code>mf</code> shows the structure of a <a href="https://miditapyr.readthedocs.io/en/latest/miditapyr.html#miditapyr.midi_frame.MidiFrames" class="external-link"><code>MidiFrames</code></a>
object and how its fields are related to the low-level functions. Have a
look <a href="https://miditapyr.readthedocs.io/en/latest/notebooks/midi_frame_usage.html" class="external-link">here</a>
to see how <code>MidiFrames</code> can be used in python.</li>
<li>The <code>pyramidi</code> subgraph illustrates how the functions in
this package work. Starting from the dataframe
<code>midi_frame_unnested</code>, the data is transformed to different
formats, finally resulting in the same format.</li>
<li>The dashed borders of the nodes in the graph depict the fields that
are in a <code>MidiFramer</code> object (for clarity not included in the
graph).</li>
<li>The <code>MidiFramer</code> method <code>update_nodes_wide()</code>
can be used to modify the field <code>df_notes_wide</code>. The red
arrows and borders show the other fields of the <code>MidiFramer</code>
object that are automatically updated when using this method.</li>
</ul></main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Urs Wilke.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
